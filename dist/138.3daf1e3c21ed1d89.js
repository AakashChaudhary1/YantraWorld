"use strict";(self.webpackChunkYantraWorld=self.webpackChunkYantraWorld||[]).push([[138],{1138:(X,h,l)=>{l.r(h),l.d(h,{BillSaaSModule:()=>z});var g=l(8781),S=l(1669),C=l(2336),a=l(433),f=l(7579),b=l(8372),_=l(1884),t=l(1571),I=l(8132),c=l(6895),v=l(2340),Z=l(6858);let x=(()=>{class i{constructor(e){this.http=e,this.url=v.N.apiUrl||localStorage.getItem("ServerUrl"),this.version=v.N.VERSION}notifyCustomer(e,n,r,s,d,p=!0){window.open(`https://wa.me/+91${r}/?text=*Dear Customer*, %0a%0a Apke ${n} product ki  ${p?s+" din ki  Warranty hai":s+" din ki  Warranty thi, Ab expire ho chuki hai"}. Please find invoice on link ${d} \n\n    Yours Truely \n\n    *${e}*.`)}createBill(e){return this.http.post("billing_saas/create",e)}getBills(e){return this.http.get("billing_saas/FilteredBills",e)}deleteBillsById(e){return this.http.delete(`billing_saas/DeleteBills/?Bill_id=${e}`)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Z.O))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var y=l(4417),B=l(7185),M=l(3931),T=l(4852),A=l(4339);function D(i,o){1&i&&(t.TgZ(0,"div"),t._uU(1,"Mobile is required"),t.qZA())}function O(i,o){1&i&&(t.TgZ(0,"div"),t._uU(1,"Mobile is Invalid"),t.qZA())}function U(i,o){if(1&i&&(t.TgZ(0,"div",31),t.YNc(1,D,2,0,"div",32),t.YNc(2,O,2,0,"div",32),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.f.Mobile.errors.required),t.xp6(1),t.Q6J("ngIf",e.f.Mobile.errors.min||e.f.Mobile.errors.max)}}function F(i,o){1&i&&(t.TgZ(0,"div"),t._uU(1,"Description is required"),t.qZA())}function q(i,o){if(1&i&&(t.TgZ(0,"div",31),t.YNc(1,F,2,0,"div",32),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.f.Description.errors.required)}}function w(i,o){1&i&&(t.TgZ(0,"div"),t._uU(1,"Warranty In Days is required"),t.qZA())}function P(i,o){1&i&&(t.TgZ(0,"div"),t._uU(1,"Min value is 0"),t.qZA())}function J(i,o){if(1&i&&(t.TgZ(0,"div",31),t.YNc(1,w,2,0,"div",32),t.YNc(2,P,2,0,"div",32),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.f.WarrantyInDays.errors.required),t.xp6(1),t.Q6J("ngIf",e.f.WarrantyInDays.errors.min)}}function N(i,o){1&i&&(t.TgZ(0,"div"),t._uU(1,"image is required"),t.qZA())}function L(i,o){if(1&i&&(t.TgZ(0,"div",31),t.YNc(1,N,2,0,"div",32),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.f.image.errors.required)}}function Y(i,o){1&i&&(t.TgZ(0,"button",33),t._uU(1,"Error in the form"),t.qZA())}function k(i,o){1&i&&(t.TgZ(0,"button",34),t._uU(1,"Submit"),t.qZA())}function W(i,o){1&i&&t._UZ(0,"i",40)}function Q(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td")(6,"img",35),t.NdJ("click",function(){const s=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.OnclickDownload(s.image))}),t.qZA()(),t.TgZ(7,"td",36),t.NdJ("click",function(){const s=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.BillingSaasService.notifyCustomer(d.user.name,s.Description,s.Mobile,s.WarrantyInDays,s.image,d.globalService.WarrantyValidator(s.WarrantyInDays,s.CreatedOn)))}),t._uU(8),t.YNc(9,W,1,0,"i",37),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.qZA(),t.TgZ(14,"td",38),t.NdJ("click",function(){const s=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.deleteBillsbyId(s))}),t._UZ(15,"i",39),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"date"),t.qZA()()}if(2&i){const e=o.$implicit,n=t.oxw();t.xp6(2),t.Oqu(e.Bill_id),t.xp6(2),t.Oqu(e.Description),t.xp6(2),t.Q6J("src",e.image,t.LSH)("alt",e.Description),t.xp6(2),t.hij(" ",e.Mobile?e.Mobile:"Not Provided"," "),t.xp6(1),t.Q6J("ngIf",e.Mobile),t.xp6(2),t.Oqu(e.WarrantyInDays),t.xp6(2),t.hij("",n.globalService.WarrantyValidator(e.WarrantyInDays,e.CreatedOn)?"Yes":"Expired"," "),t.xp6(4),t.Oqu(t.xi3(18,9,e.CreatedOn,"medium"))}}const u=function(i,o){return{"is-valid":i,"is-invalid":o}},j=[{path:"insert",canActivate:[S.B],component:(()=>{class i{constructor(e,n,r,s,d,p,m,H,V,K){this.formBuilder=e,this.OrderService=n,this.datepipe=r,this.BillingSaasService=s,this.route=d,this.dataService=p,this.toastr=m,this.router=H,this.GlobalHttpService=V,this.globalService=K,this.orderList=[],this.Count=1e3,this.orderListOriginal=[],this.SelectedUsersArr=[],this.customerList=[],this.customer=new C.O,this.loading=!1,this.submitted=!1,this.searchString="",this.BillSearchModelChanged=new f.x,this.BillsDateSearchModelChanged=new f.x,this.filterStatus=[{StatusId:1,StatusName:"Placed"},{StatusId:2,StatusName:"Confirmed"},{StatusId:6,StatusName:"Paid & DeliveryPending"}],this.customerListDropdownSettings={singleSelection:!1,idField:"customer_id",textField:"name",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:2,allowSearchFilter:!0},this.billList=[],this.today=new Date,this.billsFromDate=new Date((new Date).setDate(this.today.getDate()-30)),this.dropdownList=[],this.dropdownSettings={singleSelection:!1,idField:"StatusId",textField:"StatusName",selectAllText:"Select All",unSelectAllText:"UnSelect All",noDataAvailablePlaceholderText:"No Data Available",itemsShowLimit:4,allowSearchFilter:!0}}ngOnInit(){console.log(this.billsFromDate),this.user=this.dataService.getUserFromLocalStorage(),this.buildForm(),this.getbills(),this.searchModelChangeSubscription=this.BillSearchModelChanged.pipe((0,b.b)(1e3),(0,_.x)()).subscribe(e=>{this.searchString=e.trim(),console.log(e),this.getbills()}),this.searchModelChangeSubscription=this.BillsDateSearchModelChanged.pipe((0,b.b)(1e3),(0,_.x)()).subscribe(e=>{this.billsFromDate=e,console.log(e),this.getbills()})}buildForm(){this.BillInsertForm=this.formBuilder.group({Mobile:["",[a.kI.required,a.kI.min(5e9),a.kI.max(9999999999)]],Description:[""],IsActive:["1"],SellerDetail:[this.user.customer_id||15,[a.kI.required]],WarrantyInDays:["90",[a.kI.required,a.kI.min(0)]],image:[null,[a.kI.required]]})}get f(){return this.BillInsertForm.controls}onFileSelect(e){if(e.target.files.length>0){const n=e.target.files[0];this.BillInsertForm.get("image").setValue(n)}}deleteBillsbyId(e){console.log(12,e),confirm("Do you want to delete this?")&&this.BillingSaasService.deleteBillsById(e.Bill_id).subscribe(n=>{200==n.status&&(this.toastr.success(n.message),this.getbills())})}getbills(e=""){let r=(e=e||this.datepipe.transform(this.billsFromDate,"yyyy-MM-dd")).split("-").join("");console.log("ae",r),this.BillingSaasService.getBills({SearchString:this.searchString,count:"100",date:r}).subscribe(d=>{this.billList=d.data,console.log(11,this.billList),this.filteredBillList=d})}OnclickDownload(e){window.open(e)}onSubmit(){if(this.submitted=!0,this.BillInsertForm.invalid)return;let e=this.BillInsertForm.getRawValue();const n=new FormData;n.append("Mobile",e.Mobile),n.append("Description",e.Description),n.append("IsActive",e.IsActive),n.append("SellerDetail",e.SellerDetail),n.append("WarrantyInDays",e.WarrantyInDays),n.append("image",e.image),this.BillingSaasService.createBill(n).subscribe(r=>{this.globalService.hide(),200==r.status?(this.toastr.success("Bill Inserted Successfully!"),this.getbills(),this.BillingSaasService.notifyCustomer(this.user.name,e.Description,e.Mobile,e.WarrantyInDays,r.data.Location)):this.toastr.warning("Error!",r.data)}),console.log(this.BillInsertForm.value)}salemanSelected(){this.ProductAndItemList=[];let e={};this.orderList.forEach(n=>{n.order_details.forEach(r=>{[1,2,6].indexOf(r.status)>-1&&!r.assigned_bag_saleman&&(e[r.product_id]?(e[r.product_id].total_units+=r.units,e[r.product_id].item_ids.push(r.item_id)):e[r.product_id]={product_id:r.product_id,item_ids:[r.item_id],total_units:r.units,name:r.name})})}),this.ProductAndItemList=Object.keys(e).map(n=>e[n])}createSelectedUserArray(){this.SelectedUsersArr=[],this.SelectedUsers.forEach(e=>{this.SelectedUsersArr.push(e.customer_id)})}filterOrdersbyCustomer(){this.orderList=[],this.createSelectedUserArray(),this.orderListOriginal.filter(e=>{this.SelectedUsersArr.indexOf(e.customer_id)>-1&&!e.assigned_bag_saleman&&this.orderList.push(e)}),this.orderList=this.SelectedUsersArr.length?this.orderList:this.orderListOriginal,this.salemanSelected()}ngOnDestroy(){this.searchModelChangeSubscription.unsubscribe(),this.searchModelChangeSubscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(a.qu),t.Y36(I.p),t.Y36(c.uU),t.Y36(x),t.Y36(g.gz),t.Y36(y.D),t.Y36(B._W),t.Y36(g.F0),t.Y36(M.H),t.Y36(T.U))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-bill-insert"]],decls:76,vars:29,consts:[[1,"register-block","bill"],[1,"container"],[1,"row","register-sec"],[1,"col-xs-12","m-auto","text-center"],[1,"register-form","col-md-12",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-md-6"],[1,"form-group"],["for","Mobile","placement","top","ngbTooltip","Product ka Naam",1,"text-uppercase"],["aria-hidden","true",1,"fa","fa-info-circle"],["type","number","formControlName","Mobile",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","Description","placement","top","ngbTooltip","Description is product ka",1,"text-uppercase"],["type","text","formControlName","Description",1,"form-control",3,"ngClass"],["for","WarrantyInDays","placement","top","ngbTooltip","Any warranty for this product?",1,"text-uppercase"],["type","number","formControlName","WarrantyInDays",1,"form-control",3,"ngClass"],["for","image","placement","top","ngbTooltip","image",1,"text-uppercase"],["type","file","accept","image/*","name","image",1,"form-control",3,"ngClass","change"],[1,"form-check"],["class","btn btn-danger pull-right mt-2",4,"ngIf"],["type","submit","class","btn btn-register pull-right mt-2",4,"ngIf"],[1,"container","mt-5"],[1,"col-md-4"],["id","search-autocomplete",1,"form-outline"],["for","form1",1,"form-label","fw-bold"],["type","search","id","form1",1,"form-control",3,"ngModel","ngModelChange"],["for","date",1,"form-label","fw-bold"],["type","date","id","date",1,"form-control",3,"ngModel","ngModelChange"],[1,"table","table-striped","text-center"],["scope","col"],[4,"ngFor","ngForOf"],[1,"invalid-feedback"],[4,"ngIf"],[1,"btn","btn-danger","pull-right","mt-2"],["type","submit",1,"btn","btn-register","pull-right","mt-2"],["width","120",3,"src","alt","click"],[1,"cursor-p",3,"click"],["class","fa fa-whatsapp ft-30","aria-hidden","true",4,"ngIf"],[3,"click"],["aria-hidden","true",1,"fa","fa-trash","ft-4","cursor-p"],["aria-hidden","true",1,"fa","fa-whatsapp","ft-30"]],template:function(e,n){1&e&&(t.TgZ(0,"header"),t._UZ(1,"app-header"),t.qZA(),t.TgZ(2,"section",0)(3,"div",1)(4,"div",2)(5,"div",3)(6,"h2"),t._uU(7,"Bill Generator Software As Service"),t.qZA()(),t.TgZ(8,"form",4),t.NdJ("ngSubmit",function(){return n.onSubmit()}),t.TgZ(9,"div",5)(10,"div",6)(11,"div",7)(12,"label",8),t._uU(13,"Customer Mobile "),t._UZ(14,"i",9),t.qZA(),t._UZ(15,"input",10),t.YNc(16,U,3,2,"div",11),t.qZA(),t.TgZ(17,"div",7)(18,"label",12),t._uU(19,"Description "),t._UZ(20,"i",9),t.qZA(),t._UZ(21,"input",13),t.YNc(22,q,2,1,"div",11),t.qZA()(),t.TgZ(23,"div",6)(24,"div",7)(25,"label",14),t._uU(26,"Warranty In Days "),t._UZ(27,"i",9),t.qZA(),t._UZ(28,"input",15),t.YNc(29,J,3,2,"div",11),t.qZA(),t.TgZ(30,"div",7)(31,"label",16),t._uU(32,"image "),t._UZ(33,"i",9),t.qZA(),t.TgZ(34,"input",17),t.NdJ("change",function(s){return n.onFileSelect(s)}),t.qZA(),t.YNc(35,L,2,1,"div",11),t.qZA(),t.TgZ(36,"div",18),t.YNc(37,Y,2,0,"button",19),t.YNc(38,k,2,0,"button",20),t.qZA()()()()()(),t.TgZ(39,"div",21)(40,"div",2)(41,"div",5)(42,"div",22)(43,"div",7)(44,"div",23)(45,"label",24),t._uU(46,"Search"),t.qZA(),t.TgZ(47,"input",25),t.NdJ("ngModelChange",function(s){return n.searchString=s})("ngModelChange",function(s){return n.BillSearchModelChanged.next(s)}),t.qZA()()()(),t.TgZ(48,"div",22)(49,"div",7)(50,"div",23)(51,"label",26),t._uU(52,"Bills From Date"),t.qZA(),t.TgZ(53,"input",27),t.NdJ("ngModelChange",function(s){return n.getbills(s)}),t.ALo(54,"date"),t.qZA()()()()(),t.TgZ(55,"table",28)(56,"thead")(57,"tr")(58,"th",29),t._uU(59,"Bill Id"),t.qZA(),t.TgZ(60,"th",29),t._uU(61,"Description"),t.qZA(),t.TgZ(62,"th",29),t._uU(63,"Image"),t.qZA(),t.TgZ(64,"th",29),t._uU(65,"Mobile"),t.qZA(),t.TgZ(66,"th",29),t._uU(67,"Warranty Given"),t.qZA(),t.TgZ(68,"th",29),t._uU(69,"Warranty Remaining"),t.qZA(),t.TgZ(70,"th",29),t._uU(71,"Delete"),t.qZA(),t.TgZ(72,"th",29),t._uU(73,"Created On"),t.qZA()()(),t.TgZ(74,"tbody"),t.YNc(75,Q,19,12,"tr",30),t.qZA()()()()()),2&e&&(t.xp6(8),t.Q6J("formGroup",n.BillInsertForm),t.xp6(7),t.Q6J("ngClass",t.WLB(17,u,n.submitted,n.submitted&&n.f.Mobile.errors)),t.xp6(1),t.Q6J("ngIf",n.submitted&&n.f.Mobile.errors),t.xp6(5),t.Q6J("ngClass",t.WLB(20,u,n.submitted,n.submitted&&n.f.Description.errors)),t.xp6(1),t.Q6J("ngIf",n.submitted&&n.f.Description.errors),t.xp6(6),t.Q6J("ngClass",t.WLB(23,u,n.submitted,n.submitted&&n.f.WarrantyInDays.errors)),t.xp6(1),t.Q6J("ngIf",n.submitted&&n.f.WarrantyInDays.errors),t.xp6(5),t.Q6J("ngClass",t.WLB(26,u,n.submitted,n.submitted&&n.f.image.errors)),t.xp6(1),t.Q6J("ngIf",n.submitted&&n.f.image.errors),t.xp6(2),t.Q6J("ngIf",n.submitted&&n.BillInsertForm.invalid),t.xp6(1),t.Q6J("ngIf",!n.submitted||!n.BillInsertForm.invalid),t.xp6(9),t.Q6J("ngModel",n.searchString),t.xp6(6),t.Q6J("ngModel",t.xi3(54,14,n.billsFromDate,"yyyy-MM-dd")),t.xp6(22),t.Q6J("ngForOf",n.billList))},dependencies:[c.mk,c.sg,c.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.On,a.sg,a.u,A.P,c.uU],styles:['.register-block[_ngcontent-%COMP%]{background:#DE6262;background:linear-gradient(to bottom,#3f4c6b,#3f4c6b);float:left;width:100%;padding:50px 0;min-height:100vh}.bill[_ngcontent-%COMP%]{margin-top:35px}.banner-sec[_ngcontent-%COMP%]{background:url(https://images.pexels.com/photos/235419/pexels-photo-235419.jpeg?w=1260&h=750&auto=compress&cs=tinysrgb) no-repeat bottom;background-size:cover;min-height:500px;border-radius:0 10px 10px 0;padding:0}.container[_ngcontent-%COMP%]{background:#fff;border-radius:10px;box-shadow:15px 20px #0000001a}.carousel-inner[_ngcontent-%COMP%]{border-radius:0 10px 10px 0}.carousel-caption[_ngcontent-%COMP%]{text-align:left;left:5%}.register-sec[_ngcontent-%COMP%]{padding:50px 30px;position:relative}.register-sec[_ngcontent-%COMP%]   .copy-text[_ngcontent-%COMP%]{position:absolute;width:80%;bottom:20px;font-size:13px;text-align:center}.register-sec[_ngcontent-%COMP%]   .copy-text[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#feb58a}.register-sec[_ngcontent-%COMP%]   .copy-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#e36262}.register-sec[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:30px;font-weight:800;font-size:30px;color:#3f4c6b}.register-sec[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]:after{content:" ";width:100px;height:5px;background:#3f4c6b;display:block;margin-top:20px;border-radius:3px;margin-left:auto;margin-right:auto}.btn-register[_ngcontent-%COMP%]{background:#3f4c6b;color:#fff;font-weight:600}.banner-text[_ngcontent-%COMP%]{width:70%;position:absolute;bottom:40px;padding-left:20px}.banner-text[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fff;font-weight:600}.banner-text[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]:after{content:" ";width:100px;height:5px;background:#FFF;display:block;margin-top:20px;border-radius:3px}.banner-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff}']}),i})()},{path:"**",redirectTo:"insert"}];let G=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[g.Bz.forChild(j),g.Bz]}),i})();var $=l(2271),R=l(324);let z=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[$.m,G,R.Z.forRoot()]}),i})()}}]);